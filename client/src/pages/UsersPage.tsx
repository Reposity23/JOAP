import { useEffect,useState } from 'react';import { http } from '../api/http';
export default function UsersPage(){const [u,su]=useState<any[]>([]);const [f,sf]=useState({username:'',role:'EMPLOYEE'}); const load=()=>http.get('/admin/users').then(r=>su(r.data.data)); useEffect(load,[]); return <div className='card p-3'><h4>Users</h4><div className='d-flex gap-2 mb-2'><input className='form-control' value={f.username} onChange={e=>sf({...f,username:e.target.value})}/><select className='form-select' onChange={e=>sf({...f,role:e.target.value})}><option>EMPLOYEE</option><option>ADMIN</option></select><button className='btn btn-primary' onClick={async()=>{const r=await http.post('/admin/users',f); alert(`Temp password: ${r.data.data.tempPassword}`); load();}}>Create User</button></div><table className='table'><thead><tr><th>User</th><th>Role</th><th>Status</th><th></th></tr></thead><tbody>{u.map(x=><tr key={x._id}><td>{x.username}</td><td>{x.role}</td><td>{x.isActive?'Active':'Inactive'}</td><td><button className='btn btn-sm btn-secondary me-1' onClick={async()=>{await http.patch(`/admin/users/${x._id}/status`,{isActive:!x.isActive}); load();}}>Toggle</button><button className='btn btn-sm btn-warning me-1' onClick={async()=>{await http.patch(`/admin/users/${x._id}/role`,{role:x.role==='ADMIN'?'EMPLOYEE':'ADMIN'}); load();}}>Role</button><button className='btn btn-sm btn-danger' onClick={async()=>{const r=await http.post(`/admin/users/${x._id}/reset-password`); alert(r.data.data.tempPassword);}}>Reset</button></td></tr>)}</tbody></table></div>}
